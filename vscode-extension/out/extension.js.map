{"version":3,"file":"extension.js","mappings":"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","sources":["webpack://api-cost-guard/./src/extension.ts","webpack://api-cost-guard/external node-commonjs \"child_process\"","webpack://api-cost-guard/external commonjs \"vscode\"","webpack://api-cost-guard/external node-commonjs \"os\"","webpack://api-cost-guard/external node-commonjs \"fs\"","webpack://api-cost-guard/external node-commonjs \"path\"","webpack://api-cost-guard/webpack/bootstrap","webpack://api-cost-guard/webpack/startup"],"sourcesContent":["import * as vscode from 'vscode';\nimport * as path from 'path';\nimport { spawn } from 'child_process';\nimport * as fs from 'fs';\n\nlet statusBarItem: vscode.StatusBarItem;\nlet terminal: vscode.Terminal | null = null;\nlet monitoringInterval: NodeJS.Timeout | null = null;\nlet extensionContext: vscode.ExtensionContext;\n\nexport function activate(context: vscode.ExtensionContext) {\n    extensionContext = context;\n    // Create status bar item\n    statusBarItem = vscode.window.createStatusBarItem(\n        vscode.StatusBarAlignment.Left,\n        100 // Priority\n    );\n    statusBarItem.command = 'apiCostGuard.showStatus';\n    context.subscriptions.push(statusBarItem);\n\n    // Register commands\n    const commands = [\n        vscode.commands.registerCommand('apiCostGuard.showStatus', () => showStatus()),\n        vscode.commands.registerCommand('apiCostGuard.startMonitoring', () => startMonitoring()),\n        vscode.commands.registerCommand('apiCostGuard.stopMonitoring', () => stopMonitoring()),\n        vscode.commands.registerCommand('apiCostGuard.showSettings', () => showSettings())\n    ];\n\n    commands.forEach(command => context.subscriptions.push(command));\n\n    // Initial status update\n    updateStatusBar();\n\n    // Auto-update status every 2 minutes\n    const interval = setInterval(updateStatusBar, 2 * 60 * 1000) as any;\n    context.subscriptions.push({ dispose: () => clearInterval(interval) });\n\n    // Monitor package.json for changes\n    const watcher = vscode.workspace.createFileSystemWatcher('**/package.json');\n    context.subscriptions.push(watcher.onDidChange(() => {\n        // User installed a new AI package - update status\n        updateStatusBar();\n    }));\n}\n\nfunction updateStatusBar(): void {\n    const config = vscode.workspace.getConfiguration('apiCostGuard');\n    const apiKey = config.get<string>('apiKey');\n    \n    if (!apiKey) {\n        statusBarItem.text = '$(graph) Not Configured';\n        statusBarItem.tooltip = 'API Cost Guard: Configure API key to start monitoring';\n        statusBarItem.color = new vscode.ThemeColor('editorError.foreground');\n        return;\n    }\n\n    // Try to get quick status\n    try {\n        const apiCostPath = getApiCostPath();\n        if (apiCostPath) {\n            const { execSync } = require('child_process');\n            const result = execSync(`${apiCostPath} status --json`, { encoding: 'utf8', stdio: 'pipe' });\n            const data = JSON.parse(result);\n            \n            if (data.totalCost > 0) {\n                statusBarItem.text = `$${data.totalCost.toFixed(2)}`;\n                statusBarItem.tooltip = `API Cost Guard: $${data.totalCost.toFixed(2)} spent this month (${data.budgetUsed.toFixed(1)}% of budget)`;\n                \n                // Color based on budget usage\n                if (data.budgetUsed >= 90) {\n                    statusBarItem.color = new vscode.ThemeColor('minimap.errorHighlight');\n                } else if (data.budgetUsed >= 70) {\n                    statusBarItem.color = new vscode.ThemeColor('minimap.warningHighlight');\n                } else {\n                    statusBarItem.color = new vscode.ThemeColor('editor.foreground');\n                }\n            } else {\n                statusBarItem.text = '$0.00';\n                statusBarItem.tooltip = 'API Cost Guard: No usage recorded yet';\n                statusBarItem.color = new vscode.ThemeColor('editor.foreground');\n            }\n        }\n    } catch (error) {\n        statusBarItem.text = '$(error) Error';\n        statusBarItem.tooltip = 'API Cost Guard: Failed to fetch status';\n        statusBarItem.color = new vscode.ThemeColor('minimap.errorHighlight');\n    }\n}\n\nfunction getApiCostPath(): string | null {\n    // Try to find api-cost in the system\n    const possiblePaths = [\n        '/usr/local/bin/api-cost',\n        '/opt/homebrew/bin/api-cost',\n        path.join(process.env.HOME || '', '.npm-global/bin/api-cost')\n    ];\n\n    for (const path of possiblePaths) {\n        try {\n            fs.accessSync(path, fs.constants.X_OK);\n            return path;\n        } catch {\n            continue;\n        }\n    }\n    return null;\n}\n\nfunction showStatus(): void {\n    const apiCostPath = getApiCostPath();\n    if (!apiCostPath) {\n        vscode.window.showErrorMessage('API Cost Guard not found. Please install it first: npm install -g api-cost-guard');\n        return;\n    }\n\n    // Create or show terminal\n    if (!terminal) {\n        terminal = vscode.window.createTerminal({\n            name: 'API Cost Guard',\n            shellPath: process.platform === 'win32' ? 'cmd.exe' : 'bash'\n        });\n        extensionContext.subscriptions.push(terminal);\n    }\n\n    terminal.sendText(`api-cost status\\n`);\n    terminal.show();\n}\n\nfunction startMonitoring(): void {\n    const apiCostPath = getApiCostPath();\n    if (!apiCostPath) {\n        vscode.window.showErrorMessage('API Cost Guard not found. Please install it first: npm install -g api-cost-guard');\n        return;\n    }\n\n    if (monitoringInterval) {\n        vscode.window.showInformationMessage('Monitoring is already running');\n        return;\n    }\n\n    // Create terminal for monitoring\n    if (!terminal) {\n        terminal = vscode.window.createTerminal({\n            name: 'API Cost Monitor',\n            shellPath: process.platform === 'win32' ? 'cmd.exe' : 'bash'\n        });\n        extensionContext.subscriptions.push(terminal);\n    }\n\n    terminal.sendText(`api-cost monitor\\n`);\n    terminal.show();\n\n    // Start monitoring in terminal\n    monitoringInterval = setInterval(() => {\n        updateStatusBar();\n    }, 30 * 1000); // Update every 30 seconds\n\n    vscode.window.showInformationMessage('API Cost monitoring started in terminal');\n}\n\nfunction stopMonitoring(): void {\n    if (monitoringInterval) {\n        clearInterval(monitoringInterval);\n        monitoringInterval = null;\n    }\n\n    if (terminal) {\n        terminal.sendText('\\x03'); // Send Ctrl+C\n        terminal.dispose();\n        terminal = null;\n    }\n\n    vscode.window.showInformationMessage('API Cost monitoring stopped');\n}\n\nfunction showSettings(): void {\n    const config = vscode.workspace.getConfiguration('apiCostGuard');\n    \n    const editConfig = vscode.Uri.file(\n        path.join(require('os').homedir(), '.api-cost', 'config.json')\n    );\n\n    vscode.workspace.openTextDocument(editConfig).then((doc) => {\n        if (doc) {\n            vscode.window.showTextDocument(doc);\n        } else {\n            vscode.window.showInformationMessage('Config file not found. Run \"api-cost init\" to create one.');\n        }\n    });\n}\n\nexport function deactivate() {\n    if (monitoringInterval) {\n        clearInterval(monitoringInterval);\n    }\n    if (terminal) {\n        terminal.dispose();\n    }\n}","module.exports = require(\"child_process\");","module.exports = require(\"vscode\");","module.exports = require(\"os\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(265);\n"],"names":["context","extensionContext","statusBarItem","vscode","window","createStatusBarItem","StatusBarAlignment","Left","command","subscriptions","push","commands","registerCommand","getApiCostPath","terminal","createTerminal","name","shellPath","process","platform","sendText","show","showErrorMessage","monitoringInterval","showInformationMessage","setInterval","updateStatusBar","clearInterval","dispose","workspace","getConfiguration","editConfig","Uri","file","path","join","openTextDocument","then","doc","showTextDocument","showSettings","forEach","interval","watcher","createFileSystemWatcher","onDidChange","get","text","tooltip","color","ThemeColor","apiCostPath","execSync","result","encoding","stdio","data","JSON","parse","totalCost","toFixed","budgetUsed","error","possiblePaths","env","HOME","fs","accessSync","constants","X_OK","module","exports","require","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}